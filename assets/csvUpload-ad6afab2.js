import{t as h,a as b}from"./11_08-ed8f2ac7.js";import{l as d,o as _,c as g,b as t,d as s,e as f,F as v,k as i}from"./index-55faa955.js";const m=["background"],w={width:"100%",border:"0",cellspacing:"0",cellpadding:"0"},y={valign:"top"},k={width:"100%",border:"0",cellspacing:"0",cellpadding:"0"},C=["background"],x=t("table",{border:"0",cellspacing:"0",cellpadding:"5"},[t("tbody",null,[t("tr",null,[t("td",null,"csv檔案上傳")])])],-1),F=[x],U={width:"100%",border:"0",cellspacing:"0",cellpadding:"0"},B={width:"100%",border:"0",cellspacing:"1",cellpadding:"5"},E={bgcolor:"#E7F0C9"},I={width:"55%",bgcolor:"#E7F0C9"},D={__name:"csvUpload",setup(L){const e=d(""),c=d("");function r(l){e.value=l.target.files}function u(){if(confirm("確定上傳?"))if(e.value&&e.value.length){let n=e.value[0].name.split(".");if(n[n.length-1]=="csv"){let a=new FormData;a.append("file",e.value[0]),i.post("/api/app/csv/upload",a,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{alert("上傳成功"),c.value.value="",e.value=""}).catch(()=>{alert("上傳失敗，請在確認檔案內容")})}else alert("只能選擇csv類型檔案")}else alert("尚未選擇檔案")}function p(){i.get("/api/app/csv/chtusers").then(l=>{var n=new Blob([l],{type:"text/csv"}),a=window.URL.createObjectURL(n),o=document.createElement("a");o.href=a,o.download="chtusers.csv",document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(a),document.body.removeChild(o),alert("下載成功")})}return(l,n)=>(_(),g(v,null,[t("tr",null,[t("td",{background:s(h),style:{width:"100%"}},[t("table",w,[t("tbody",null,[t("tr",null,[t("td",y,[t("table",k,[t("tbody",null,[t("tr",null,[t("td",{height:"44",background:s(b),style:{width:"800px"}},F,8,C)])])])])])])])],8,m)]),t("tr",null,[t("table",U,[t("tbody",null,[t("tr",null,[t("td",null,[t("table",B,[t("tbody",null,[t("tr",E,[t("td",I,[f(" 請選取csv檔案--- "),t("input",{type:"file",name:"",id:"",accept:".csv",onChange:r,ref_key:"fileInput",ref:c},null,544)]),t("td",{width:"29%"},[t("button",{type:"button",onClick:u},"上傳")]),t("td",{width:"29%"},[t("button",{type:"button",onClick:p},"下載")])])])])])])])])])],64))}};export{D as default};
